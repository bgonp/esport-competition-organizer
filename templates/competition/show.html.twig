{% extends 'base.html.twig' %}

{% block content %}
<div class="row">
    {% if competition.isopen == false %}
    {% include 'brackets/bracket_8.html.twig' %}
    {% endif %}
</div>
{% if competition.isopen == false %}
<div>
    <h1>Equipos</h1>
    {% for team in competition.teams %}

    <div class="w-50 my-2 bg-light border">
        <div class="card-body">
            <h5 class="card-title sport-text">{{ team.name }}</h5>
            <ul class="list-group">
                {% for player in team.players %}
                <li class="list-group-item sport-text">{{ player.username }}
                    <!--<a href="#"><i class="fas fa-skull"></i></a>-->
                </li>
                {% endfor %}
            </ul>

        </div>
    </div>
    {% endfor %}
{% endif %}
    <div style="min-height: 867px;" >
        <h1>{% if competition.isopen %}{{competition.name}} - {% endif %}Jugadores Registrados</h1>
        <ul class="list-group list-group-flush sport-text mb-3">
            {% for registration in competition.registrations %}
            <li class="list-group-item w-50">{{ registration.player.username }}
                {% if competition.isopen and (competition.streamer == app.user or is_granted('ROLE_ADMIN')) %}
                <span class="float-right">
                    <!--<a href="#"><i class="fas fa-skull"></i></a>-->
                    <form action="{{ path('registration_delete') }}" method="POST" class="d-inline">
                        <input type="hidden" name="competitionId" value="{{ competition.id }}">
                        <input type="hidden" name="playerId" value="{{ player.id }}">
                        <button class="btn fas fa-skull controlls" type="submit" value="ban"></button>
                    </form>
                    <form action="{{ path('toggle_confirmation') }}" method="POST" class="d-inline">
                        <input type="hidden" name="competitionId" value="{{ competition.id }}">
                        <input type="hidden" name="playerId" value="{{ player.id }}">
                    {% if registration.isConfirmed == true %}
                        <button class="btn far fa-check-square controlls" type="submit" value="Unconfirm"></button>
                    {% else %}
                        <button class="btn far fa-square controlls" type="submit" value="Confirm"></button>
                    {% endif %}
                 </form>
                </span>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        
    {% if createStreamerButtons %}
<a class="btn btn-dark mb-3 sport-text" href="{{ path('competition_edit', {id: competition.id}) }}">Editar Torneo</a>
        <form action="{{ path('competition_delete') }}" method="POST" class="d-inline">
        <input type="hidden" name="competition_id" value="{{ competition.id }}">
        <input class="btn btn-dark sport-text mb-3" type="submit" value="Eliminar">
    </form>
{% endif %}
{% if createRegistrationButtons %}
    {% if player in competition.players %}
        <form action="{{ path('registration_delete') }}" method="POST" class="d-inline">
            <input type="hidden" name="competitionId" value="{{ competition.id }}">
            <input type="hidden" name="playerId" value="{{ player.id }}">
            <input class="btn btn-dark sport-text mb-3" type="submit" value="Abandonar">
        </form>
    {% else %}
        <form action="{{ path('registration_new') }}" method="POST" class="d-inline">
            <input type="hidden" name="id" value="{{ competition.id }}">
            <input class="btn btn-dark sport-text mb-3" type="submit" value="Unirse">
        </form>
    {% endif %}
{% if createRandomizeButton  %}
<a class="btn btn-dark mb-3" href="{{ path('competition_randomize', {id: competition.id}) }}">Randomize Competition</a>
{% endif %}
{% endif %}
</div>
</div>
{% endblock %}
